version: '3.8'

services:
  frequi:
    image: ${DOCKER_REGISTRY:-ghcr.io}/haoweichan/freqtrade/freqtrade-ui:${IMAGE_TAG:-latest}
    # build:
    #   context: ./ui
    #   dockerfile: Dockerfile
    #   args:
    #     FT_UI_USERNAME: ${FT_UI_USERNAME:-admin}
    #     FT_UI_PASSWORD: ${FT_UI_PASSWORD:-admin123}
    # NOTE: Build section commented out to force use of pre-built registry image
    # For local development, uncomment the build section above
    container_name: freqtrade-ui
    restart: unless-stopped
    ports:
      - "8080:80"
    depends_on:
      - freqtrade-ichiv1
      - freqtrade-lookaheadstrategy
      - freqtrade-macd
      - freqtrade-customstoplosswithpsar
      - freqtrade-macdcci

  freqtrade-ichiv1:
    image: ${DOCKER_REGISTRY:-ghcr.io}/haoweichan/freqtrade/freqtrade-bot:${IMAGE_TAG:-latest}
    build: .
    container_name: freqtrade-trader-ichi_v1-DRYRUN  # Clear mode indicator
    restart: unless-stopped
    environment:
      - FREQTRADE__DRY_RUN=${ICHI_DRY_RUN:-true}  # Per-bot dry-run control
      - FREQTRADE__TELEGRAM__ENABLED=true
      - FREQTRADE__TELEGRAM__ACCEPT_COMMANDS=true
      - FREQTRADE__EXCHANGE__KEY=${BINANCE_KEY}
      - FREQTRADE__EXCHANGE__SECRET=${BINANCE_SECRET}
      - FREQTRADE__TELEGRAM__TOKEN=${TELEGRAM_TOKEN}
      - FREQTRADE__TELEGRAM__CHAT_ID=${TELEGRAM_CHAT_ID}
      - FREQTRADE__API_SERVER__USERNAME=${FT_UI_USERNAME}
      - FREQTRADE__API_SERVER__PASSWORD=${FT_UI_PASSWORD}
    ports:
      - "8081:8080"
    volumes:
      - "./user_data/ichi:/freqtrade/user_data"  # Isolated database and logs
    command: >
      trade
      --config /freqtrade/user_data/config.json
      --strategy ichiV1

  freqtrade-lookaheadstrategy:
    image: ${DOCKER_REGISTRY:-ghcr.io}/haoweichan/freqtrade/freqtrade-bot:${IMAGE_TAG:-latest}
    build: .
    container_name: freqtrade-trader-lookahead_strategy-DRYRUN  # Clear mode indicator
    restart: unless-stopped
    environment:
      - FREQTRADE__DRY_RUN=${LOOKAHEAD_DRY_RUN:-true}  # Per-bot dry-run control
      - FREQTRADE__TELEGRAM__ENABLED=true  # Enable Telegram notifications
      - FREQTRADE__TELEGRAM__ACCEPT_COMMANDS=true  # Allow Telegram commands
      - FREQTRADE__EXCHANGE__KEY=${BINANCE_KEY}
      - FREQTRADE__EXCHANGE__SECRET=${BINANCE_SECRET}
      - FREQTRADE__TELEGRAM__TOKEN=${TELEGRAM_TOKEN}
      - FREQTRADE__TELEGRAM__CHAT_ID=${TELEGRAM_CHAT_ID}
      - FREQTRADE__API_SERVER__USERNAME=${FT_UI_USERNAME}
      - FREQTRADE__API_SERVER__PASSWORD=${FT_UI_PASSWORD}
    ports:
      - "8082:8080"
    volumes:
      - "./user_data/lookahead:/freqtrade/user_data"  # Isolated database and logs
    command: >
      trade
      --config /freqtrade/user_data/config.json
      --strategy LookaheadStrategy

  freqtrade-macd:
    image: ${DOCKER_REGISTRY:-ghcr.io}/haoweichan/freqtrade/freqtrade-bot:${IMAGE_TAG:-latest}
    build: .
    container_name: freqtrade-trader-macd-DRYRUN  # Clear mode indicator
    restart: unless-stopped
    environment:
      - FREQTRADE__DRY_RUN=${MACD_DRY_RUN:-true}  # Per-bot dry-run control
      - FREQTRADE__TELEGRAM__ENABLED=true  # Enable Telegram notifications
      - FREQTRADE__TELEGRAM__ACCEPT_COMMANDS=true  # Allow Telegram commands
      - FREQTRADE__EXCHANGE__KEY=${BINANCE_KEY}
      - FREQTRADE__EXCHANGE__SECRET=${BINANCE_SECRET}
      - FREQTRADE__TELEGRAM__TOKEN=${TELEGRAM_TOKEN}
      - FREQTRADE__TELEGRAM__CHAT_ID=${TELEGRAM_CHAT_ID}
      - FREQTRADE__API_SERVER__USERNAME=${FT_UI_USERNAME}
      - FREQTRADE__API_SERVER__PASSWORD=${FT_UI_PASSWORD}
    ports:
      - "8083:8080"
    volumes:
      - "./user_data/macd:/freqtrade/user_data"  # Isolated database and logs
    command: >
      trade
      --config /freqtrade/user_data/config.json
      --strategy Macd

  freqtrade-customstoplosswithpsar:
    image: ${DOCKER_REGISTRY:-ghcr.io}/haoweichan/freqtrade/freqtrade-bot:${IMAGE_TAG:-latest}
    build: .
    container_name: freqtrade-trader-custom_stoploss_with_psar-DRYRUN  # Clear mode indicator
    restart: unless-stopped
    environment:
      - FREQTRADE__DRY_RUN=${PSAR_DRY_RUN:-true}  # Per-bot dry-run control
      - FREQTRADE__TELEGRAM__ENABLED=true  # Enable Telegram notifications
      - FREQTRADE__TELEGRAM__ACCEPT_COMMANDS=true  # Allow Telegram commands
      - FREQTRADE__EXCHANGE__KEY=${BINANCE_KEY}
      - FREQTRADE__EXCHANGE__SECRET=${BINANCE_SECRET}
      - FREQTRADE__TELEGRAM__TOKEN=${TELEGRAM_TOKEN}
      - FREQTRADE__TELEGRAM__CHAT_ID=${TELEGRAM_CHAT_ID}
      - FREQTRADE__API_SERVER__USERNAME=${FT_UI_USERNAME}
      - FREQTRADE__API_SERVER__PASSWORD=${FT_UI_PASSWORD}
    ports:
      - "8084:8080"
    volumes:
      - "./user_data/psar:/freqtrade/user_data"  # Isolated database and logs
    command: >
      trade
      --config /freqtrade/user_data/config.json
      --strategy CustomStoplossWithPSAR

  freqtrade-macdcci:
    image: ${DOCKER_REGISTRY:-ghcr.io}/haoweichan/freqtrade/freqtrade-bot:${IMAGE_TAG:-latest}
    build: .
    container_name: freqtrade-trader-macdcci-DRYRUN  # Clear mode indicator
    restart: unless-stopped
    environment:
      - FREQTRADE__DRY_RUN=${MACDCCI_DRY_RUN:-true}  # Per-bot dry-run control
      - FREQTRADE__TELEGRAM__ENABLED=true  # Enable Telegram notifications
      - FREQTRADE__TELEGRAM__ACCEPT_COMMANDS=true  # Allow Telegram commands
      - FREQTRADE__EXCHANGE__KEY=${BINANCE_KEY}
      - FREQTRADE__EXCHANGE__SECRET=${BINANCE_SECRET}
      - FREQTRADE__TELEGRAM__TOKEN=${TELEGRAM_TOKEN}
      - FREQTRADE__TELEGRAM__CHAT_ID=${TELEGRAM_CHAT_ID}
      - FREQTRADE__API_SERVER__USERNAME=${FT_UI_USERNAME}
      - FREQTRADE__API_SERVER__PASSWORD=${FT_UI_PASSWORD}
    ports:
      - "8085:8080"
    volumes:
      - "./user_data/macdcci:/freqtrade/user_data"  # Isolated database and logs
    command: >
      trade
      --config /freqtrade/user_data/config.json
      --strategy MACDCCI
